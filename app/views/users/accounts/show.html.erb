<% content_for :subnav do %>
  <div class="<%= subnav_css %>">
    <div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-lg px-4">
      <%= users_tabs 'Account' %>
    </div>
  </div>
<% end %>

<div class="lg:w-2/3 mx-auto mt-4 space-y-6">
  <%= display_flash %>

  <% if current_user.oauth_user? %>
    <!-- OAuth Information -->
    <div class="resource-container">
      <div class="resource-header">
        <div>
          <h3 class="resource-title">Connected via OAuth</h3>
          <p class="resource-description">Your account authentication details.</p>
        </div>
      </div>

      <div class="p-4">
        <div class="space-y-3">
          <div class="flex items-center">
            <span class="text-sm font-medium text-gray-900 dark:text-gray-200 w-32">Provider:</span>
            <span class="text-sm text-gray-700 dark:text-gray-300"><%= current_user.provider_human %></span>
          </div>
          <div class="flex items-center">
            <span class="text-sm font-medium text-gray-900 dark:text-gray-200 w-32">Email:</span>
            <span class="text-sm text-gray-700 dark:text-gray-300"><%= current_user.email %></span>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <!-- Calendar Integration -->
  <div class="resource-container">
    <div class="resource-header">
      <div>
        <h3 class="resource-title">Calendar Integration</h3>
        <p class="resource-description">Manage your calendar token for task integration.</p>
      </div>
    </div>

    <div class="p-4">
      <div class="mb-4">
        <p class="text-sm text-gray-600 dark:text-gray-400">
          Your calendar token allows you to subscribe to your tasks with due dates in your calendar application.
          If you think your token has been compromised or you're experiencing issues with calendar integration,
          you can regenerate it below.
        </p>
      </div>

      <%= link_to "Regenerate Calendar Token", regenerate_calendar_token_users_account_path,
          method: :post,
          class: "inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",
          data: { turbo_method: :post, turbo_confirm: "Are you sure? This will invalidate any existing calendar subscriptions." } %>
    </div>
  </div>

  <!-- Delete Account -->
  <div class="resource-container">
    <div class="resource-header">
      <div>
        <h3 class="resource-title text-red-600 dark:text-red-400">Delete Account</h3>
        <p class="resource-description">Permanently delete your account and all associated data.</p>
      </div>
    </div>

    <div class="p-4">
      <div class="mb-4">
        <p class="text-sm text-gray-600 dark:text-gray-400">
          This action will completely remove your account and all associated data. This action cannot be undone.
        </p>
      </div>

      <%= button_to "Delete my account", users_account_path,
          data: { confirm: "Delete account with all the data? Are you sure?", turbo_confirm: "Delete account with all the data? Are you sure?" },
          method: :delete,
          class: "btn-remove" %>
    </div>
  </div>
</div>
